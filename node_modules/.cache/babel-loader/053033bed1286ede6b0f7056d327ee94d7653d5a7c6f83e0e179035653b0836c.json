{"ast":null,"code":"var _jsxFileName = \"/Users/chaenniee/Documents/team10-web/toyproject/src/components/module/ModuleBlock.tsx\",\n  _s = $RefreshSig$();\nimport styles from './ModuleBlock.module.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCaretDown, faCaretRight, faPaperclip } from '@fortawesome/free-solid-svg-icons';\nimport { useEffect, useState } from 'react';\nimport { apiGetFile, apiGetModules } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DownloadFile = _ref => {\n  let {\n    file\n  } = _ref;\n  const originalFileURL = decodeURI(file);\n  const urlParams = originalFileURL.split('/media/modules/')[1];\n  const handleDownload = async event => {\n    event.preventDefault();\n    await apiGetFile(file);\n  };\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    className: styles.download,\n    onClick: handleDownload,\n    children: urlParams\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 25,\n    columnNumber: 5\n  }, this);\n};\n_c = DownloadFile;\nconst Module = _ref2 => {\n  let {\n    module,\n    openedToggles,\n    handleSingleToggle,\n    idx\n  } = _ref2;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.moduleContainer,\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      onClick: () => handleSingleToggle(idx),\n      children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: openedToggles[idx] ? faCaretDown : faCaretRight,\n        className: styles.caret\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this), module.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      className: openedToggles[idx] ? styles.contentContainerShow : styles.contentContainer,\n      children: module.module_content.map((content, contentIdx) => /*#__PURE__*/_jsxDEV(\"section\", {\n        className: openedToggles[idx] ? styles.contentShow : styles.content,\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faPaperclip,\n          className: styles.paperClip\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DownloadFile, {\n          file: content.file\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this)]\n      }, contentIdx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n};\n_c2 = Module;\nexport default function ModuleBlock() {\n  _s();\n  const {\n    token,\n    getRefreshToken\n  } = useSessionContext();\n  const {\n    subjectid\n  } = useParams();\n  const [modules, setModules] = useState([]);\n  // module의 개수와 같은 개수의 1로 이루어진 배열 생성 (처음에는 모든 모듈이 열려 있는 상태)\n  // 모듈(토글)이 열려 있으면 1, 아니면 0\n  const [openedToggles, setOpenedToggles] = useState([]);\n  // Array(modules.length).fill(true)\n\n  const navigate = useNavigate();\n  // 각 모듈 헤더 클릭 시 접고 펼치기\n  const handleSingleToggle = id => {\n    const newOpenedToggles = [...openedToggles.slice(0, id), !openedToggles[id], ...openedToggles.slice(id + 1)];\n    setOpenedToggles(newOpenedToggles);\n  };\n\n  // 하나라도 펼쳐진 모듈이 있으면 모든 모듈 접기, 모두 접혀있으면 모든 모듈 펼치기\n  const handleAllToggle = () => {\n    if (openedToggles.includes(true)) {\n      const newOpenedToggles = Array(modules.length).fill(false);\n      setOpenedToggles(newOpenedToggles);\n    } else {\n      const newOpenedToggles = Array(modules.length).fill(true);\n      setOpenedToggles(newOpenedToggles);\n    }\n  };\n  const getModules = async (token, class_id) => {\n    const res = await apiGetModules(token, class_id);\n    return res;\n  };\n  useEffect(() => {\n    (async () => {\n      try {\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(localRefreshToken ? localRefreshToken : 'temp');\n        const id = Number(subjectid);\n        const res = await getModules(resToken.data.access, id);\n        setModules(res.data[0].weekly);\n        setOpenedToggles(Array(res.data[0].weekly.length).fill(true));\n      } catch (e) {\n        if (axios.isAxiosError(e)) {\n          var _e$response;\n          toast((_e$response = e.response) === null || _e$response === void 0 ? void 0 : _e$response.data.message);\n          navigate('/login');\n        } else {\n          console.log(e);\n        }\n      }\n    })();\n  }, [subjectid]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.wrapper,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.headerbar,\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAllToggle,\n        children: openedToggles.includes(true) ? '모든 모듈 접기' : '모든 모듈 펼치기'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      children: modules && modules.map((module, idx) => /*#__PURE__*/_jsxDEV(Module, {\n        module: module,\n        idx: idx,\n        openedToggles: openedToggles,\n        handleSingleToggle: handleSingleToggle\n      }, module.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this);\n}\n_s(ModuleBlock, \"IjXApSDfQ0TkaMA1QCuAaCBgRaE=\", false, function () {\n  return [useSessionContext, useParams, useNavigate];\n});\n_c3 = ModuleBlock;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"DownloadFile\");\n$RefreshReg$(_c2, \"Module\");\n$RefreshReg$(_c3, \"ModuleBlock\");","map":{"version":3,"names":["styles","FontAwesomeIcon","faCaretDown","faCaretRight","faPaperclip","useEffect","useState","apiGetFile","apiGetModules","useSessionContext","useNavigate","useParams","axios","toast","DownloadFile","file","originalFileURL","decodeURI","urlParams","split","handleDownload","event","preventDefault","download","Module","module","openedToggles","handleSingleToggle","idx","moduleContainer","caret","name","contentContainerShow","contentContainer","module_content","map","content","contentIdx","contentShow","paperClip","ModuleBlock","token","getRefreshToken","subjectid","modules","setModules","setOpenedToggles","navigate","id","newOpenedToggles","slice","handleAllToggle","includes","Array","length","fill","getModules","class_id","res","localRefreshToken","localStorage","getItem","resToken","Number","data","access","weekly","e","isAxiosError","response","message","console","log","wrapper","headerbar"],"sources":["/Users/chaenniee/Documents/team10-web/toyproject/src/components/module/ModuleBlock.tsx"],"sourcesContent":["import styles from './ModuleBlock.module.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCaretDown,\n  faCaretRight,\n  faPaperclip,\n} from '@fortawesome/free-solid-svg-icons';\nimport { useEffect, useState } from 'react';\nimport { apiGetFile, apiGetModules } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { ModuleInterface } from '../../lib/types';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\n\nconst DownloadFile = ({ file }: { file: string }) => {\n  const originalFileURL = decodeURI(file);\n  const urlParams = originalFileURL.split('/media/modules/')[1];\n  const handleDownload = async (event: React.MouseEvent<HTMLSpanElement>) => {\n    event.preventDefault();\n    await apiGetFile(file);\n  };\n\n  return (\n    <span className={styles.download} onClick={handleDownload}>\n      {urlParams}\n    </span>\n  );\n};\n\nconst Module = ({\n  module,\n  openedToggles,\n  handleSingleToggle,\n  idx,\n}: {\n  module: ModuleInterface;\n  openedToggles: boolean[];\n  handleSingleToggle: (id: number) => void;\n  idx: number;\n}) => {\n  return (\n    <div className={styles.moduleContainer}>\n      <header onClick={() => handleSingleToggle(idx)}>\n        <FontAwesomeIcon\n          icon={openedToggles[idx] ? faCaretDown : faCaretRight}\n          className={styles.caret}\n        />\n        {module.name}\n      </header>\n\n      <article\n        className={\n          openedToggles[idx]\n            ? styles.contentContainerShow\n            : styles.contentContainer\n        }\n      >\n        {module.module_content.map((content, contentIdx) => (\n          <section\n            key={contentIdx}\n            className={openedToggles[idx] ? styles.contentShow : styles.content}\n          >\n            <FontAwesomeIcon icon={faPaperclip} className={styles.paperClip} />\n            <DownloadFile file={content.file} />\n            {/* <a href={content.file} download>\n              download\n            </a> */}\n          </section>\n        ))}\n      </article>\n      {/* )} */}\n    </div>\n  );\n};\n\nexport default function ModuleBlock() {\n  const { token, getRefreshToken } = useSessionContext();\n  const { subjectid } = useParams();\n  const [modules, setModules] = useState<ModuleInterface[]>([]);\n  // module의 개수와 같은 개수의 1로 이루어진 배열 생성 (처음에는 모든 모듈이 열려 있는 상태)\n  // 모듈(토글)이 열려 있으면 1, 아니면 0\n  const [openedToggles, setOpenedToggles] = useState<boolean[]>([]);\n  // Array(modules.length).fill(true)\n\n  const navigate = useNavigate();\n  // 각 모듈 헤더 클릭 시 접고 펼치기\n  const handleSingleToggle = (id: number) => {\n    const newOpenedToggles = [\n      ...openedToggles.slice(0, id),\n      !openedToggles[id],\n      ...openedToggles.slice(id + 1),\n    ];\n    setOpenedToggles(newOpenedToggles);\n  };\n\n  // 하나라도 펼쳐진 모듈이 있으면 모든 모듈 접기, 모두 접혀있으면 모든 모듈 펼치기\n  const handleAllToggle = () => {\n    if (openedToggles.includes(true)) {\n      const newOpenedToggles = Array(modules.length).fill(false);\n      setOpenedToggles(newOpenedToggles);\n    } else {\n      const newOpenedToggles = Array(modules.length).fill(true);\n      setOpenedToggles(newOpenedToggles);\n    }\n  };\n\n  const getModules = async (token: string | null, class_id: number) => {\n    const res = await apiGetModules(token, class_id);\n    return res;\n  };\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(\n          localRefreshToken ? localRefreshToken : 'temp'\n        );\n        const id = Number(subjectid);\n        const res = await getModules(resToken.data.access, id);\n        setModules(res.data[0].weekly);\n        setOpenedToggles(Array(res.data[0].weekly.length).fill(true));\n      } catch (e) {\n        if (axios.isAxiosError(e)) {\n          toast(e.response?.data.message);\n          navigate('/login');\n        } else {\n          console.log(e);\n        }\n      }\n    })();\n  }, [subjectid]);\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.headerbar}>\n        <button onClick={handleAllToggle}>\n          {openedToggles.includes(true) ? '모든 모듈 접기' : '모든 모듈 펼치기'}\n        </button>\n      </div>\n      <article>\n        {modules &&\n          modules.map((module, idx) => (\n            <Module\n              key={module.id}\n              module={module}\n              idx={idx}\n              openedToggles={openedToggles}\n              handleSingleToggle={handleSingleToggle}\n            />\n          ))}\n      </article>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}