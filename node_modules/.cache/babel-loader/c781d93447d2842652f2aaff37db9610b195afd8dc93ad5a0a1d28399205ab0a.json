{"ast":null,"code":"var _jsxFileName = \"/Users/chaenniee/Documents/portfolio/toyproject/src/components/assignments/AssignmentPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport AssignmentBlock from './AssignmentBlock';\nimport styles from './AssignmentPage.module.scss';\nimport SubjectTemplate from '../SubjectTemplate';\nimport { useParams } from 'react-router-dom';\nimport { apiAssignments, apiAllAssignmentScore } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction sortByCategory(assignments) {\n  for (const assignment of assignments) {}\n}\nexport default function AssignmentPage() {\n  _s();\n  const {\n    token,\n    getRefreshToken\n  } = useSessionContext();\n  const {\n    subjectid\n  } = useParams();\n\n  /** states */\n  const [isCategorized, setIsCategorized] = useState(true);\n  const [assignments, setAssignments] = useState([]);\n  const [scores, setScores] = useState([]);\n  const [userAssignments, setUserAssignments] = useState([]);\n  const [assignmentsByCategory, setAssignmentsByCategory] = useState([]);\n  const [assignmentsByTime, setAssignmentsByTime] = useState([]);\n  const [searchValue, setSearchValue] = useState(\"\");\n  const getAllAssignments = (token, class_id) => {\n    apiAssignments(token, class_id).then(r => {\n      setAssignments(r.data);\n      getAssignmentScore(token, class_id);\n    }).catch(r => console.log(r));\n  };\n  const getAssignmentScore = (token, class_id) => {\n    apiAllAssignmentScore(token, class_id).then(r => {\n      setScores(r.data);\n    }).catch(r => console.log(r));\n  };\n  useEffect(() => {\n    if (!token) return;\n    (async () => {\n      try {\n        const id = Number(subjectid);\n        getAllAssignments(token, id);\n      } catch {\n        const id = Number(subjectid);\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(localRefreshToken ? localRefreshToken : 'temp');\n        const newToken = resToken.data.access;\n        getAllAssignments(newToken, id);\n      }\n    })();\n  }, [setAssignments, setScores, setAssignmentsByCategory, token]);\n  useEffect(() => {\n    const searchResult = assignments.filter(a => a.name.includes(searchValue));\n    assignments && scores && setUserAssignments(searchResult.map(a => {\n      var _scores$index, _scores$index2, _scores$index3;\n      let index = scores.findIndex(s => s.assignment === a.id);\n      return {\n        assignment: a,\n        is_submitted: (_scores$index = scores[index]) === null || _scores$index === void 0 ? void 0 : _scores$index.is_submitted,\n        is_graded: (_scores$index2 = scores[index]) === null || _scores$index2 === void 0 ? void 0 : _scores$index2.is_graded,\n        score: (_scores$index3 = scores[index]) === null || _scores$index3 === void 0 ? void 0 : _scores$index3.score\n      };\n    }));\n    const duplicatedCategories = userAssignments.map(u => u.assignment.category);\n    const uniqueCategories = duplicatedCategories.filter((elem, idx) => {\n      return duplicatedCategories.indexOf(elem) === idx;\n    });\n    setAssignmentsByCategory(uniqueCategories.map(cat => {\n      return {\n        category: cat,\n        assignments: userAssignments.filter(u => u.assignment.category === cat)\n      };\n    }));\n    const copy = [...userAssignments];\n    copy.sort(u => parseInt(u.assignment.due_date));\n    setAssignmentsByTime([{\n      category: \"마감일 순\",\n      assignments: copy\n    }]);\n  }, [assignments, scores, searchValue, setSearchValue]);\n  return /*#__PURE__*/_jsxDEV(SubjectTemplate, {\n    subject: subjectid,\n    page: \"\\uACFC\\uC81C\",\n    content: undefined,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.wrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: styles.header,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"\\uACFC\\uC81C \\uAC80\\uC0C9\",\n          onChange: e => setSearchValue(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: isCategorized ? undefined : styles.categorized,\n          onClick: () => setIsCategorized(false),\n          children: \"\\uB9C8\\uAC10\\uC21C\\uC73C\\uB85C \\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: isCategorized ? styles.categorized : undefined,\n          onClick: () => setIsCategorized(true),\n          children: \"\\uC720\\uD615\\uBCC4\\uB85C \\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), isCategorized ? assignmentsByCategory.map(elem => /*#__PURE__*/_jsxDEV(AssignmentBlock, {\n        isCategorized: true,\n        assignmentBlock: elem.assignments\n      }, elem.category, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }, this)) : assignmentsByTime.map(elem => /*#__PURE__*/_jsxDEV(AssignmentBlock, {\n        isCategorized: false,\n        assignmentBlock: elem.assignments\n      }, elem.category, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 19\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n_s(AssignmentPage, \"fihnijrBSODrbiTHJoo4aWgZBvM=\", false, function () {\n  return [useSessionContext, useParams];\n});\n_c = AssignmentPage;\nvar _c;\n$RefreshReg$(_c, \"AssignmentPage\");","map":{"version":3,"names":["React","useEffect","useState","AssignmentBlock","styles","SubjectTemplate","useParams","apiAssignments","apiAllAssignmentScore","useSessionContext","sortByCategory","assignments","assignment","AssignmentPage","token","getRefreshToken","subjectid","isCategorized","setIsCategorized","setAssignments","scores","setScores","userAssignments","setUserAssignments","assignmentsByCategory","setAssignmentsByCategory","assignmentsByTime","setAssignmentsByTime","searchValue","setSearchValue","getAllAssignments","class_id","then","r","data","getAssignmentScore","catch","console","log","id","Number","localRefreshToken","localStorage","getItem","resToken","newToken","access","searchResult","filter","a","name","includes","map","index","findIndex","s","is_submitted","is_graded","score","duplicatedCategories","u","category","uniqueCategories","elem","idx","indexOf","cat","copy","sort","parseInt","due_date","undefined","wrapper","header","e","target","value","categorized"],"sources":["/Users/chaenniee/Documents/portfolio/toyproject/src/components/assignments/AssignmentPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport AssignmentBlock from './AssignmentBlock';\nimport styles from './AssignmentPage.module.scss';\nimport SubjectTemplate from '../SubjectTemplate';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { AssignmentInterface, UserAssignmentInterface } from '../../lib/types';\nimport {\n  apiAssignments,\n  apiAllAssignmentScore,\n} from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\n\nfunction sortByCategory(assignments: UserAssignmentInterface[]) {\n  for (const assignment of assignments) {\n  }\n}\n\ninterface Score {\n  id: number;\n  assignment: number;\n  is_submitted: boolean;\n  is_graded: boolean;\n  score: number;\n}\n\ninterface categorizedAssignments {\n  category: string;\n  assignments: UserAssignmentInterface[];\n}\n\nexport default function AssignmentPage() {\n  const { token, getRefreshToken } = useSessionContext();\n  const { subjectid } = useParams();\n\n  /** states */\n  const [isCategorized, setIsCategorized] = useState(true);\n  const [assignments, setAssignments] = useState<AssignmentInterface[]>([]);\n  const [scores, setScores] = useState<Score[]>([]);\n  const [userAssignments, setUserAssignments] = useState<UserAssignmentInterface[]>([]);\n  const [assignmentsByCategory, setAssignmentsByCategory] = useState<categorizedAssignments[]>([]);\n  const [assignmentsByTime, setAssignmentsByTime] = useState<categorizedAssignments[]>([]);\n  const [searchValue, setSearchValue] = useState<string>(\"\");\n\n  const getAllAssignments = (token: string | null, class_id: number) => {\n    apiAssignments(token, class_id)\n      .then((r) => {\n        setAssignments(r.data);\n        getAssignmentScore(token, class_id);\n      })\n      .catch((r) => console.log(r));\n  };\n\n  const getAssignmentScore = (token: string | null, class_id: number) => {\n    apiAllAssignmentScore(token, class_id)\n      .then((r) => {\n        setScores(r.data);\n      })\n      .catch((r) => console.log(r));\n  };\n\n  useEffect(() => {\n    if (!token) return;\n    (async () => {\n      try {\n        const id = Number(subjectid);\n        getAllAssignments(token, id);\n      } catch {\n        const id = Number(subjectid);\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(\n          localRefreshToken ? localRefreshToken : 'temp'\n        );\n        const newToken = resToken.data.access;\n        getAllAssignments(newToken, id);\n      }\n    })();\n  }, [setAssignments, setScores, setAssignmentsByCategory, token]);\n\n  useEffect(() => {\n    const searchResult = assignments.filter((a) => a.name.includes(searchValue));\n    assignments && scores && setUserAssignments(\n        searchResult.map((a) => {\n          let index = scores.findIndex((s) => s.assignment === a.id);\n          return {\n            assignment: a,\n            is_submitted: scores[index]?.is_submitted,\n            is_graded: scores[index]?.is_graded,\n            score: scores[index]?.score,\n          };\n        })\n    );\n    const duplicatedCategories = userAssignments.map(u => u.assignment.category);\n    const uniqueCategories = duplicatedCategories.filter((elem, idx) => {\n      return duplicatedCategories.indexOf(elem) === idx;\n    });\n    setAssignmentsByCategory(uniqueCategories.map((cat) => {\n      return {\n        category: cat,\n        assignments: userAssignments.filter((u) => u.assignment.category === cat)\n      }\n    }));\n    const copy = [...userAssignments];\n    copy.sort((u: UserAssignmentInterface) => parseInt(u.assignment.due_date));\n    setAssignmentsByTime([{\n      category: \"마감일 순\",\n      assignments: copy\n    }])\n  }, [assignments, scores, searchValue, setSearchValue])\n\n  return (\n    <SubjectTemplate\n      subject={subjectid as string}\n      page='과제'\n      content={undefined}\n    >\n      <div className={styles.wrapper}>\n        <header className={styles.header}>\n          <input placeholder='과제 검색' onChange={(e) => setSearchValue(e.target.value)}/>\n          <button\n            className={isCategorized ? undefined : styles.categorized}\n            onClick={() => setIsCategorized(false)}\n          >\n            마감순으로 보기\n          </button>\n          <button\n            className={isCategorized ? styles.categorized : undefined}\n            onClick={() => setIsCategorized(true)}\n          >\n            유형별로 보기\n          </button>\n        </header>\n        {\n          isCategorized ?\n          assignmentsByCategory.map((elem) => (\n            <AssignmentBlock\n                isCategorized={true}\n              key={elem.category}\n              assignmentBlock={elem.assignments}\n            />\n          )) :\n              assignmentsByTime.map((elem) => (\n                  <AssignmentBlock\n                      isCategorized={false}\n                      key={elem.category}\n                      assignmentBlock={elem.assignments}\n                  />\n              ))\n        }\n      </div>\n    </SubjectTemplate>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}