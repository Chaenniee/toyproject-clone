{"ast":null,"code":"var _jsxFileName = \"/Users/chaenniee/Documents/team10-web/toyproject/src/components/assignments/AssignmentPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport AssignmentBlock from './AssignmentBlock';\nimport styles from './AssignmentPage.module.scss';\nimport SubjectTemplate from '../SubjectTemplate';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { apiAssignments, apiAllAssignmentScore } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction sortByCategory(assignments) {\n  for (const assignment of assignments) {}\n}\nexport default function AssignmentPage() {\n  _s();\n  const {\n    token,\n    getRefreshToken\n  } = useSessionContext();\n  const {\n    subjectid\n  } = useParams();\n  const [isCategorized, setIsCategorized] = useState(true);\n  // const [assignmentsByTime, setAssignmentsByTime] = useState<AssignmentInterface>({\n  //     assignments: []\n  // });\n  const [assignments, setAssignments] = useState([]);\n  const [scores, setScores] = useState([]);\n  const [userAssignments, setUserAssignments] = useState([]);\n  const [categoryBlocks, setCategoryBlocks] = useState([]);\n  const navigate = useNavigate();\n  const getAllAssignments = (token, class_id) => {\n    apiAssignments(token, class_id).then(r => {\n      setAssignments(r.data);\n      console.log(r.data);\n      getAssignmentScore(token, class_id);\n    }).catch(r => console.log(r));\n  };\n  const getAssignmentScore = (token, class_id) => {\n    apiAllAssignmentScore(token, class_id).then(r => {\n      setScores(r.data);\n      console.log(r.data);\n      setUserAssignments(assignments.map(a => {\n        let index = scores.findIndex(s => s.id === a.id);\n        return {\n          assignment: a,\n          is_submitted: scores[index].is_submitted,\n          is_graded: scores[index].is_graded,\n          score: scores[index].score\n        };\n      }));\n    }).catch(r => console.log(r));\n  };\n  useEffect(() => {\n    if (!token) return;\n    (async () => {\n      try {\n        const id = Number(subjectid);\n        getAllAssignments(token, id);\n      } catch {\n        const id = Number(subjectid);\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(localRefreshToken ? localRefreshToken : 'temp');\n        const newToken = resToken.data.access;\n        getAllAssignments(newToken, id);\n      }\n    })();\n  }, [setAssignments, setScores, setCategoryBlocks, token]);\n  return /*#__PURE__*/_jsxDEV(SubjectTemplate, {\n    subject: subjectid,\n    page: \"\\uACFC\\uC81C\",\n    content: undefined,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.wrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: styles.header,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"\\uACFC\\uC81C \\uAC80\\uC0C9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: isCategorized ? undefined : styles.categorized,\n          onClick: () => setIsCategorized(!isCategorized),\n          children: \"\\uB9C8\\uAC10\\uC21C\\uC73C\\uB85C \\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: isCategorized ? styles.categorized : undefined,\n          onClick: () => setIsCategorized(!isCategorized),\n          children: \"\\uC720\\uD615\\uBCC4\\uB85C \\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), categoryBlocks.map(elem => /*#__PURE__*/_jsxDEV(AssignmentBlock, {\n        assignmentBlock: elem.assignments\n      }, elem.category, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n}\n_s(AssignmentPage, \"J79XpAIgBb8Eckch1fOVKQP4sBo=\", false, function () {\n  return [useSessionContext, useParams, useNavigate];\n});\n_c = AssignmentPage;\nvar _c;\n$RefreshReg$(_c, \"AssignmentPage\");","map":{"version":3,"names":["React","useEffect","useState","AssignmentBlock","styles","SubjectTemplate","useNavigate","useParams","apiAssignments","apiAllAssignmentScore","useSessionContext","sortByCategory","assignments","assignment","AssignmentPage","token","getRefreshToken","subjectid","isCategorized","setIsCategorized","setAssignments","scores","setScores","userAssignments","setUserAssignments","categoryBlocks","setCategoryBlocks","navigate","getAllAssignments","class_id","then","r","data","console","log","getAssignmentScore","catch","map","a","index","findIndex","s","id","is_submitted","is_graded","score","Number","localRefreshToken","localStorage","getItem","resToken","newToken","access","undefined","wrapper","header","categorized","elem","category"],"sources":["/Users/chaenniee/Documents/team10-web/toyproject/src/components/assignments/AssignmentPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport AssignmentBlock from './AssignmentBlock';\nimport styles from './AssignmentPage.module.scss';\nimport SubjectTemplate from '../SubjectTemplate';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { AssignmentInterface, UserAssignmentInterface } from '../../lib/types';\nimport {\n  apiAssignments,\n  apiAssignmentScore,\n  apiAllAssignmentScore,\n} from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\n\nfunction sortByCategory(assignments: UserAssignmentInterface[]) {\n  for (const assignment of assignments) {\n  }\n}\n\ninterface Score {\n  id: number;\n  is_submitted: boolean;\n  is_graded: boolean;\n  score: number;\n}\n\nexport default function AssignmentPage() {\n  const { token, getRefreshToken } = useSessionContext();\n  const { subjectid } = useParams();\n  const [isCategorized, setIsCategorized] = useState(true);\n  // const [assignmentsByTime, setAssignmentsByTime] = useState<AssignmentInterface>({\n  //     assignments: []\n  // });\n  const [assignments, setAssignments] = useState<AssignmentInterface[]>([]);\n  const [scores, setScores] = useState<Score[]>([]);\n  const [userAssignments, setUserAssignments] = useState<\n    UserAssignmentInterface[]\n  >([]);\n  const [categoryBlocks, setCategoryBlocks] = useState<\n    {\n      category: string;\n      assignments: UserAssignmentInterface[];\n    }[]\n  >([]);\n  const navigate = useNavigate();\n\n  const getAllAssignments = (token: string | null, class_id: number) => {\n    apiAssignments(token, class_id)\n      .then((r) => {\n        setAssignments(r.data);\n        console.log(r.data);\n        getAssignmentScore(token, class_id);\n      })\n      .catch((r) => console.log(r));\n  };\n\n  const getAssignmentScore = (token: string | null, class_id: number) => {\n    apiAllAssignmentScore(token, class_id)\n      .then((r) => {\n        setScores(r.data);\n        console.log(r.data);\n        setUserAssignments(\n          assignments.map((a) => {\n            let index = scores.findIndex((s) => s.id === a.id);\n            return {\n              assignment: a,\n              is_submitted: scores[index].is_submitted,\n              is_graded: scores[index].is_graded,\n              score: scores[index].score,\n            };\n          })\n        );\n      })\n      .catch((r) => console.log(r));\n  };\n\n  useEffect(() => {\n    if (!token) return;\n    (async () => {\n      try {\n        const id = Number(subjectid);\n        getAllAssignments(token, id);\n      } catch {\n        const id = Number(subjectid);\n        const localRefreshToken = localStorage.getItem('refresh');\n        const resToken = await getRefreshToken(\n          localRefreshToken ? localRefreshToken : 'temp'\n        );\n        const newToken = resToken.data.access;\n        getAllAssignments(newToken, id);\n      }\n    })();\n  }, [setAssignments, setScores, setCategoryBlocks, token]);\n\n  return (\n    <SubjectTemplate\n      subject={subjectid as string}\n      page='과제'\n      content={undefined}\n    >\n      <div className={styles.wrapper}>\n        <header className={styles.header}>\n          <input placeholder='과제 검색' />\n          <button\n            className={isCategorized ? undefined : styles.categorized}\n            onClick={() => setIsCategorized(!isCategorized)}\n          >\n            마감순으로 보기\n          </button>\n          <button\n            className={isCategorized ? styles.categorized : undefined}\n            onClick={() => setIsCategorized(!isCategorized)}\n          >\n            유형별로 보기\n          </button>\n        </header>\n        {categoryBlocks.map((elem) => (\n          <AssignmentBlock\n            key={elem.category}\n            assignmentBlock={elem.assignments}\n          />\n        ))}\n      </div>\n    </SubjectTemplate>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}