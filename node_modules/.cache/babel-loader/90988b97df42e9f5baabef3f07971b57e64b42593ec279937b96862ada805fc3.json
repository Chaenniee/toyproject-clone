{"ast":null,"code":"var _jsxFileName = \"/Users/chaenniee/Documents/team10-web/toyproject/src/components/auth/KakaoLoginPage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport ClipLoader from 'react-spinners/ClipLoader';\nimport styles from './KakaoLoginPage.module.scss';\nimport { apiGetUserInfo, apiKakaoLogin } from '../../lib/api';\nimport { useNavigate } from 'react-router-dom';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function KakaoLoginPage() {\n  _s();\n  const {\n    setToken,\n    setUser,\n    setColors,\n    setIsLoggedIn\n  } = useSessionContext();\n  const navigate = useNavigate();\n  useEffect(() => {\n    (async () => {\n      let code = new URL(window.location.href).searchParams.get('code');\n      console.log(code);\n      const res = await apiKakaoLogin(code);\n      setToken(res.data.access_token);\n      localStorage.setItem('refresh', res.data.refresh_token); //우선 로컬storage에 refresh 저장해둠\n      localStorage.setItem('userId', res.data.user);\n      const userInfoRes = await apiGetUserInfo(res.data.user, res.data.access_token);\n      console.log(userInfoRes);\n      if (userInfoRes.data.username === null) {\n        navigate('/login/social');\n      } else {\n        setIsLoggedIn(true);\n        setUser(userInfoRes.data);\n        setColors(userInfoRes.data.classes.map(c => {\n          return {\n            id: c.id,\n            color: '#97bdf5'\n          };\n        }));\n        navigate('/');\n      }\n      //refreshtoken, access token 저장하기\n      console.log(res);\n    })();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.wrapper,\n    children: /*#__PURE__*/_jsxDEV(ClipLoader, {\n      loading: true,\n      color: '#0F0F6E',\n      size: 60\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n_s(KakaoLoginPage, \"S3R16H/KmRodKp8pt261ehdTmYk=\", false, function () {\n  return [useSessionContext, useNavigate];\n});\n_c = KakaoLoginPage;\nvar _c;\n$RefreshReg$(_c, \"KakaoLoginPage\");","map":{"version":3,"names":["React","useEffect","ClipLoader","styles","apiGetUserInfo","apiKakaoLogin","useNavigate","useSessionContext","KakaoLoginPage","setToken","setUser","setColors","setIsLoggedIn","navigate","code","URL","window","location","href","searchParams","get","console","log","res","data","access_token","localStorage","setItem","refresh_token","user","userInfoRes","username","classes","map","c","id","color","wrapper"],"sources":["/Users/chaenniee/Documents/team10-web/toyproject/src/components/auth/KakaoLoginPage.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport ClipLoader from 'react-spinners/ClipLoader';\nimport styles from './KakaoLoginPage.module.scss';\nimport axios from 'axios';\nimport { apiGetUserInfo, apiKakaoLogin, url } from '../../lib/api';\nimport { useNavigate } from 'react-router-dom';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { CardColor, SubjectType } from '../../lib/types';\n\nexport default function KakaoLoginPage() {\n  const { setToken, setUser, setColors, setIsLoggedIn } = useSessionContext();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    (async () => {\n      let code = new URL(window.location.href).searchParams.get('code');\n      console.log(code);\n      const res = await apiKakaoLogin(code);\n      setToken(res.data.access_token);\n      localStorage.setItem('refresh', res.data.refresh_token); //우선 로컬storage에 refresh 저장해둠\n      localStorage.setItem('userId', res.data.user);\n      const userInfoRes = await apiGetUserInfo(\n        res.data.user,\n        res.data.access_token\n      );\n      console.log(userInfoRes);\n\n      if (userInfoRes.data.username === null) {\n        navigate('/login/social');\n      } else {\n        setIsLoggedIn(true);\n        setUser(userInfoRes.data);\n        setColors(\n          userInfoRes.data.classes.map((c: SubjectType): CardColor => {\n            return {\n              id: c.id,\n              color: '#97bdf5',\n            };\n          })\n        );\n        navigate('/');\n      }\n      //refreshtoken, access token 저장하기\n      console.log(res);\n    })();\n  }, []);\n\n  return (\n    <div className={styles.wrapper}>\n      <ClipLoader loading={true} color={'#0F0F6E'} size={60}></ClipLoader>\n    </div>\n  );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,OAAOC,UAAU,MAAM,2BAA2B;AAClD,OAAOC,MAAM,MAAM,8BAA8B;AAEjD,SAASC,cAAc,EAAEC,aAAa,QAAa,eAAe;AAClE,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,iBAAiB,QAAQ,8BAA8B;AAAC;AAGjE,eAAe,SAASC,cAAc,GAAG;EAAA;EACvC,MAAM;IAAEC,QAAQ;IAAEC,OAAO;IAAEC,SAAS;IAAEC;EAAc,CAAC,GAAGL,iBAAiB,EAAE;EAC3E,MAAMM,QAAQ,GAAGP,WAAW,EAAE;EAE9BL,SAAS,CAAC,MAAM;IACd,CAAC,YAAY;MACX,IAAIa,IAAI,GAAG,IAAIC,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC,CAACC,YAAY,CAACC,GAAG,CAAC,MAAM,CAAC;MACjEC,OAAO,CAACC,GAAG,CAACR,IAAI,CAAC;MACjB,MAAMS,GAAG,GAAG,MAAMlB,aAAa,CAACS,IAAI,CAAC;MACrCL,QAAQ,CAACc,GAAG,CAACC,IAAI,CAACC,YAAY,CAAC;MAC/BC,YAAY,CAACC,OAAO,CAAC,SAAS,EAAEJ,GAAG,CAACC,IAAI,CAACI,aAAa,CAAC,CAAC,CAAC;MACzDF,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEJ,GAAG,CAACC,IAAI,CAACK,IAAI,CAAC;MAC7C,MAAMC,WAAW,GAAG,MAAM1B,cAAc,CACtCmB,GAAG,CAACC,IAAI,CAACK,IAAI,EACbN,GAAG,CAACC,IAAI,CAACC,YAAY,CACtB;MACDJ,OAAO,CAACC,GAAG,CAACQ,WAAW,CAAC;MAExB,IAAIA,WAAW,CAACN,IAAI,CAACO,QAAQ,KAAK,IAAI,EAAE;QACtClB,QAAQ,CAAC,eAAe,CAAC;MAC3B,CAAC,MAAM;QACLD,aAAa,CAAC,IAAI,CAAC;QACnBF,OAAO,CAACoB,WAAW,CAACN,IAAI,CAAC;QACzBb,SAAS,CACPmB,WAAW,CAACN,IAAI,CAACQ,OAAO,CAACC,GAAG,CAAEC,CAAc,IAAgB;UAC1D,OAAO;YACLC,EAAE,EAAED,CAAC,CAACC,EAAE;YACRC,KAAK,EAAE;UACT,CAAC;QACH,CAAC,CAAC,CACH;QACDvB,QAAQ,CAAC,GAAG,CAAC;MACf;MACA;MACAQ,OAAO,CAACC,GAAG,CAACC,GAAG,CAAC;IAClB,CAAC,GAAG;EACN,CAAC,EAAE,EAAE,CAAC;EAEN,oBACE;IAAK,SAAS,EAAEpB,MAAM,CAACkC,OAAQ;IAAA,uBAC7B,QAAC,UAAU;MAAC,OAAO,EAAE,IAAK;MAAC,KAAK,EAAE,SAAU;MAAC,IAAI,EAAE;IAAG;MAAA;MAAA;MAAA;IAAA;EAAc;IAAA;IAAA;IAAA;EAAA,QAChE;AAEV;AAAC,GA3CuB7B,cAAc;EAAA,QACoBD,iBAAiB,EACxDD,WAAW;AAAA;AAAA,KAFNE,cAAc;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}