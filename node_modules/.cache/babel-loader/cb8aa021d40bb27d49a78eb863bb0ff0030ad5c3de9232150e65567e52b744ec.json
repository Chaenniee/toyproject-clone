{"ast":null,"code":"var _jsxFileName = \"/Users/chaenniee/Documents/team10-web/toyproject/src/components/module/ModuleBlock.tsx\",\n  _s = $RefreshSig$();\nimport styles from './ModuleBlock.module.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCaretDown, faCaretRight, faPaperclip } from '@fortawesome/free-solid-svg-icons';\nimport { useEffect, useState } from 'react';\nimport { apiGetFile, apiGetModules } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DownloadFile = _ref => {\n  let {\n    file\n  } = _ref;\n  const originalFileURL = decodeURI(file);\n  const urlParams = originalFileURL.split('/media/modules/')[1];\n  const handleDownload = async event => {\n    event.preventDefault();\n    await apiGetFile(file);\n  };\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    className: styles.download,\n    onClick: handleDownload,\n    children: urlParams\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 23,\n    columnNumber: 5\n  }, this);\n};\n_c = DownloadFile;\nconst Module = _ref2 => {\n  let {\n    module,\n    openedToggles,\n    handleSingleToggle,\n    idx\n  } = _ref2;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.moduleContainer,\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      onClick: () => handleSingleToggle(idx),\n      children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: openedToggles[idx] ? faCaretDown : faCaretRight,\n        className: styles.caret\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this), module.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      className: openedToggles[idx] ? styles.contentContainerShow : styles.contentContainer,\n      children: module.module_content.map((content, contentIdx) => /*#__PURE__*/_jsxDEV(\"section\", {\n        className: openedToggles[idx] ? styles.contentShow : styles.content,\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faPaperclip,\n          className: styles.paperClip\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DownloadFile, {\n          file: content.file\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 13\n        }, this)]\n      }, contentIdx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 5\n  }, this);\n};\n_c2 = Module;\nexport default function ModuleBlock() {\n  _s();\n  const {\n    token\n  } = useSessionContext();\n  const {\n    subjectid\n  } = useParams();\n  const [modules, setModules] = useState([]);\n  // module의 개수와 같은 개수의 1로 이루어진 배열 생성 (처음에는 모든 모듈이 열려 있는 상태)\n  // 모듈(토글)이 열려 있으면 1, 아니면 0\n  const [openedToggles, setOpenedToggles] = useState([]);\n  // Array(modules.length).fill(true)\n\n  // 각 모듈 헤더 클릭 시 접고 펼치기\n  const handleSingleToggle = id => {\n    const newOpenedToggles = [...openedToggles.slice(0, id), !openedToggles[id], ...openedToggles.slice(id + 1)];\n    setOpenedToggles(newOpenedToggles);\n  };\n\n  // 하나라도 펼쳐진 모듈이 있으면 모든 모듈 접기, 모두 접혀있으면 모든 모듈 펼치기\n  const handleAllToggle = () => {\n    if (openedToggles.includes(true)) {\n      const newOpenedToggles = Array(modules.length).fill(false);\n      setOpenedToggles(newOpenedToggles);\n    } else {\n      const newOpenedToggles = Array(modules.length).fill(true);\n      setOpenedToggles(newOpenedToggles);\n    }\n  };\n  const getModules = async (token, class_id) => {\n    const res = await apiGetModules(token, class_id);\n    return res;\n  };\n  useEffect(() => {\n    (async () => {\n      const id = Number(subjectid);\n      if (token) {\n        const res = await getModules(token, id);\n        setModules(res.data[0].weekly);\n        setOpenedToggles(Array(res.data[0].weekly.length).fill(true));\n      }\n    })();\n  }, [token, subjectid]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.wrapper,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.headerbar,\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAllToggle,\n        children: openedToggles.includes(true) ? '모든 모듈 접기' : '모든 모듈 펼치기'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      children: modules && modules.map((module, idx) => /*#__PURE__*/_jsxDEV(Module, {\n        module: module,\n        idx: idx,\n        openedToggles: openedToggles,\n        handleSingleToggle: handleSingleToggle\n      }, module.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 5\n  }, this);\n}\n_s(ModuleBlock, \"4pxHss1QChBKgnoej+WGonIZGgU=\", false, function () {\n  return [useSessionContext, useParams];\n});\n_c3 = ModuleBlock;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"DownloadFile\");\n$RefreshReg$(_c2, \"Module\");\n$RefreshReg$(_c3, \"ModuleBlock\");","map":{"version":3,"names":["styles","FontAwesomeIcon","faCaretDown","faCaretRight","faPaperclip","useEffect","useState","apiGetFile","apiGetModules","useSessionContext","useParams","DownloadFile","file","originalFileURL","decodeURI","urlParams","split","handleDownload","event","preventDefault","download","Module","module","openedToggles","handleSingleToggle","idx","moduleContainer","caret","name","contentContainerShow","contentContainer","module_content","map","content","contentIdx","contentShow","paperClip","ModuleBlock","token","subjectid","modules","setModules","setOpenedToggles","id","newOpenedToggles","slice","handleAllToggle","includes","Array","length","fill","getModules","class_id","res","Number","data","weekly","wrapper","headerbar"],"sources":["/Users/chaenniee/Documents/team10-web/toyproject/src/components/module/ModuleBlock.tsx"],"sourcesContent":["import styles from './ModuleBlock.module.scss';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCaretDown,\n  faCaretRight,\n  faPaperclip,\n} from '@fortawesome/free-solid-svg-icons';\nimport { useEffect, useState } from 'react';\nimport { apiGetFile, apiGetModules } from '../../lib/api';\nimport { useSessionContext } from '../../context/SessionContext';\nimport { useParams } from 'react-router-dom';\nimport { ModuleInterface } from '../../lib/types';\n\nconst DownloadFile = ({ file }: { file: string }) => {\n  const originalFileURL = decodeURI(file);\n  const urlParams = originalFileURL.split('/media/modules/')[1];\n  const handleDownload = async (event: React.MouseEvent<HTMLSpanElement>) => {\n    event.preventDefault();\n    await apiGetFile(file);\n  };\n\n  return (\n    <span className={styles.download} onClick={handleDownload}>\n      {urlParams}\n    </span>\n  );\n};\n\nconst Module = ({\n  module,\n  openedToggles,\n  handleSingleToggle,\n  idx,\n}: {\n  module: ModuleInterface;\n  openedToggles: boolean[];\n  handleSingleToggle: (id: number) => void;\n  idx: number;\n}) => {\n  return (\n    <div className={styles.moduleContainer}>\n      <header onClick={() => handleSingleToggle(idx)}>\n        <FontAwesomeIcon\n          icon={openedToggles[idx] ? faCaretDown : faCaretRight}\n          className={styles.caret}\n        />\n        {module.name}\n      </header>\n\n      <article\n        className={\n          openedToggles[idx]\n            ? styles.contentContainerShow\n            : styles.contentContainer\n        }\n      >\n        {module.module_content.map((content, contentIdx) => (\n          <section\n            key={contentIdx}\n            className={openedToggles[idx] ? styles.contentShow : styles.content}\n          >\n            <FontAwesomeIcon icon={faPaperclip} className={styles.paperClip} />\n            <DownloadFile file={content.file} />\n            {/* <a href={content.file} download>\n              download\n            </a> */}\n          </section>\n        ))}\n      </article>\n      {/* )} */}\n    </div>\n  );\n};\n\nexport default function ModuleBlock() {\n  const { token } = useSessionContext();\n  const { subjectid } = useParams();\n  const [modules, setModules] = useState<ModuleInterface[]>([]);\n  // module의 개수와 같은 개수의 1로 이루어진 배열 생성 (처음에는 모든 모듈이 열려 있는 상태)\n  // 모듈(토글)이 열려 있으면 1, 아니면 0\n  const [openedToggles, setOpenedToggles] = useState<boolean[]>([]);\n  // Array(modules.length).fill(true)\n\n  // 각 모듈 헤더 클릭 시 접고 펼치기\n  const handleSingleToggle = (id: number) => {\n    const newOpenedToggles = [\n      ...openedToggles.slice(0, id),\n      !openedToggles[id],\n      ...openedToggles.slice(id + 1),\n    ];\n    setOpenedToggles(newOpenedToggles);\n  };\n\n  // 하나라도 펼쳐진 모듈이 있으면 모든 모듈 접기, 모두 접혀있으면 모든 모듈 펼치기\n  const handleAllToggle = () => {\n    if (openedToggles.includes(true)) {\n      const newOpenedToggles = Array(modules.length).fill(false);\n      setOpenedToggles(newOpenedToggles);\n    } else {\n      const newOpenedToggles = Array(modules.length).fill(true);\n      setOpenedToggles(newOpenedToggles);\n    }\n  };\n\n  const getModules = async (token: string | null, class_id: number) => {\n    const res = await apiGetModules(token, class_id);\n    return res;\n  };\n\n  useEffect(() => {\n    (async () => {\n      const id = Number(subjectid);\n      if (token) {\n        const res = await getModules(token, id);\n        setModules(res.data[0].weekly);\n        setOpenedToggles(Array(res.data[0].weekly.length).fill(true));\n      }\n    })();\n  }, [token, subjectid]);\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.headerbar}>\n        <button onClick={handleAllToggle}>\n          {openedToggles.includes(true) ? '모든 모듈 접기' : '모든 모듈 펼치기'}\n        </button>\n      </div>\n      <article>\n        {modules &&\n          modules.map((module, idx) => (\n            <Module\n              key={module.id}\n              module={module}\n              idx={idx}\n              openedToggles={openedToggles}\n              handleSingleToggle={handleSingleToggle}\n            />\n          ))}\n      </article>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}